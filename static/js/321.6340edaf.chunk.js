"use strict";(self.webpackChunkmusicovery_front=self.webpackChunkmusicovery_front||[]).push([[321],{486:(e,s,a)=>{a.d(s,{A:()=>n});var t=a(5043),l=a(4935),i=a(6375),c=a(579);const n=e=>{let{onSelectTrack:s}=e;const{keyword:a,setKeyword:n,results:r,handleSearch:d,isPremium:o}=(0,i.A)(),[h,m]=(0,t.useState)(!1);return(0,c.jsxs)("div",{className:"music-search",children:[o,(0,c.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d(),m(!0)},children:[" ",(0,c.jsx)("input",{className:"music-search-input",type:"text",value:a,onChange:e=>n(e.target.value),placeholder:"\uc74c\uc545 \uac80\uc0c9"}),(0,c.jsx)("button",{type:"submit",children:"\ud83d\udd0e"})]}),(0,c.jsx)("div",{className:"music-search-results",children:h||0!==r.length?r.map(((e,a)=>(0,c.jsx)("div",{onClick:()=>s(e),children:(0,c.jsx)(l.A,{track:e,isPremium:o})},e.id))):(0,c.jsx)("div",{className:"music-search-placeholder",children:"\uac80\uc0c9\uc5b4 \uc785\ub825..."})})]})}},4935:(e,s,a)=>{a.d(s,{A:()=>m});var t=a(5043),l=a(7950),i=a(5026),c=a(4003),n=a(7138),r=a(9428),d=a(579);const o=t.memo((e=>{let{playlist:s,isChecked:a,onCheck:t}=e;return(0,d.jsxs)("div",{className:"playlist-modal-item",children:[(0,d.jsx)("input",{type:"checkbox",id:`playlist-${s.playlistId}`,checked:a,onChange:()=>t(s.playlistId)}),(0,d.jsxs)("label",{htmlFor:`playlist-${s.playlistId}`,className:"playlist-modal-label",children:[(0,d.jsx)("div",{className:"playlist-modal-image-container",children:(0,d.jsx)("img",{src:(0,n.V)(s.playlistPhoto),alt:s.playlistTitle,className:"playlist-modal-image"})}),(0,d.jsx)("span",{className:"playlist-modal-name",children:s.playlistTitle})]})]})})),h=t.memo((e=>{let{playlists:s,selectedPlaylists:a,loading:t,onCheck:l,onClose:i,onAdd:c}=e;return(0,d.jsx)("div",{className:"playlist-modal-overlay",onClick:i,children:(0,d.jsxs)("div",{className:"playlist-modal",onClick:e=>e.stopPropagation(),children:[(0,d.jsxs)("div",{className:"playlist-modal-header",children:[(0,d.jsx)("h3",{children:"\ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8\uc5d0 \ucd94\uac00"}),(0,d.jsx)("button",{className:"playlist-modal-close",onClick:i,children:"\xd7"})]}),(0,d.jsx)("div",{className:"playlist-modal-body",children:t?(0,d.jsx)("p",{children:"\ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."}):0===s.length?(0,d.jsx)("p",{children:"\uc0ac\uc6a9 \uac00\ub2a5\ud55c \ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,d.jsx)("div",{className:"playlist-modal-list",children:s.map((e=>(0,d.jsx)(o,{playlist:e,isChecked:a.includes(e.playlistId),onCheck:l},e.playlistId)))})}),(0,d.jsx)("div",{className:"playlist-modal-footer",children:(0,d.jsx)("button",{className:"add-to-playlist-button",onClick:c,disabled:0===a.length||t,children:"\ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8\uc5d0 \ucd94\uac00"})})]})})})),m=e=>{let{track:s,isPremium:a}=e;const[n,o]=(0,t.useState)({}),[m,u]=(0,t.useState)(!1),[p,x]=(0,t.useState)([]),[j,y]=(0,t.useState)([]),[v,f]=(0,t.useState)(!1),{addTrackToList:g,setIsPlaying:N,deviceReady:b}=(0,t.useContext)(r.vC),k=(0,t.useRef)(!1),C=(0,c.A)(),I=()=>{u(!1),y([])},A=(0,t.useCallback)((e=>{y((s=>s.includes(e)?s.filter((s=>s!==e)):[...s,e]))}),[]);return s&&s.album&&s.album.images&&s.album.images[0]?(0,d.jsxs)("div",{className:"track-item",onMouseEnter:e=>{const s=e.currentTarget.getBoundingClientRect();o({top:s.top-10+"px",left:`${s.left+s.width/2}px`})},onMouseLeave:()=>{o({})},children:[(0,d.jsx)("img",{className:"track-album-image-music",src:s.album.images[0].url,alt:s.name}),(0,d.jsxs)("div",{className:"track-info",children:[(0,d.jsx)("h4",{children:s.name}),(0,d.jsx)("p",{children:s.artists.map((e=>e.name)).join(", ")}),(0,d.jsxs)("div",{className:"tooltip",style:n,children:[(0,d.jsx)("h4",{children:s.name}),(0,d.jsx)("p",{children:s.artists.map((e=>e.name)).join(", ")})]})]}),(0,d.jsxs)("div",{className:"track-play-button-container",children:[(0,d.jsx)("button",{onClick:()=>(async e=>{if(a)try{g(e),b?N(!0):b||setTimeout((()=>{N(!0)}),1e3)}catch(l){var s,t;if(console.error("\ud2b8\ub799 \uc7ac\uc0dd \uc911 \uc624\ub958:",l),403===(null===(s=l.response)||void 0===s?void 0:s.status))return void window.open(e.external_urls.spotify,"_blank");404===(null===(t=l.response)||void 0===t?void 0:t.status)?alert("Spotify \ud50c\ub808\uc774\uc5b4\ub97c \ucd08\uae30\ud654 \uc911\uc785\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4\uc5d0 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."):alert("\ud2b8\ub799\uc744 \uc7ac\uc0dd\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.")}else window.open(e.external_urls.spotify,"_blank")})(s),className:a?"premium-play":"spotify-link",children:a?"\u25b6":"LINK"}),(0,d.jsx)("button",{className:"add-track-to-playlist-button",onClick:()=>{u(!0),C&&!k.current&&(async e=>{if(e&&!k.current){f(!0);try{const s=await i.A.get(`/playlist/user/${e}`);x(s.data||[]),k.current=!0}catch(s){console.error("\ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8\ub97c \ubd88\ub7ec\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4:",s)}finally{f(!1)}}})(C.userId)},children:"\u2795"})]}),m&&l.createPortal((0,d.jsx)(h,{playlists:p,selectedPlaylists:j,loading:v,onCheck:A,onClose:I,onAdd:async()=>{if(0!==j.length)try{const e=j.map((e=>i.A.post(`/api/spotify/playlist/${e}/track`,null,{params:{trackId:s.id}})));await Promise.all(e),alert("\uc120\ud0dd\ud55c \ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8\uc5d0 \ud2b8\ub799\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),I()}catch(e){console.error("\ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8\uc5d0 \ud2b8\ub799 \ucd94\uac00 \uc2e4\ud328:",e),alert("\ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8\uc5d0 \ud2b8\ub799 \ucd94\uac00 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}else alert("\ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8\ub97c \uc120\ud0dd\ud574\uc8fc\uc138\uc694.")}}),document.body)]},s.id):null}},5520:(e,s,a)=>{a.d(s,{A:()=>o});var t=a(5043),l=a(486),i=a(5026),c=a(4003),n=a(1675),r=a(579);const d=()=>{const e=(0,n.Zp)(),[s,a]=(0,t.useState)([]),[l,d]=(0,t.useState)([]),[o,h]=(0,t.useState)([]),[m,u]=(0,t.useState)(!1),[p,x]=(0,t.useState)(""),[j,y]=(0,t.useState)([]),[v,f]=(0,t.useState)("search"),g=(0,c.A)();(0,t.useEffect)((()=>{g&&(N(),b(),k())}),[g]);const N=async()=>{try{const e=await i.A.get(`/friends/list?userId=${g.id}`);a(e.data)}catch(e){console.error("\uce5c\uad6c \ubaa9\ub85d\uc744 \uac00\uc838\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",e)}},b=async()=>{try{const e=await i.A.get(`/friends/friendRequests?friendId=${g.id}`);d(e.data)}catch(e){console.error("\uce5c\uad6c \uc694\uccad \ubaa9\ub85d\uc744 \uac00\uc838\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",e)}},k=async()=>{try{const e=await i.A.get(`/friends/pendingRequests?userId=${g.id}`);h(e.data)}catch(e){console.error("\ub0b4\uac00 \uc694\uccad\ud55c \uce5c\uad6c \ubaa9\ub85d\uc744 \uac00\uc838\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",e)}},C=e=>s.some((s=>s.friend.id===e))||l.some((s=>s.user.id===e))||o.some((s=>s.friend.id===e));return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"friends-list-container",children:[(0,r.jsx)("h2",{children:"\uce5c\uad6c \ubaa9\ub85d"}),(0,r.jsx)("button",{onClick:()=>u(!0),className:"add-friend-button",children:"\uce5c\uad6c \ucd94\uac00"}),(0,r.jsx)("div",{className:"friends-list",children:s.map((s=>(0,r.jsxs)("div",{className:"friend-item",onClick:()=>(s=>{e("/playlistPage",{state:{friendInfo:s}})})(s.friend.id===g.id?s.user:s.friend),children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"\uce5c\uad6c \ubcc4\uba85 :"})," ",s.friend.id===g.id?s.user.nickname:s.friend.nickname]}),(0,r.jsx)("button",{className:"friend-delete-button",onClick:e=>(async(e,s)=>{s.stopPropagation();try{await i.A.delete("/friends/delete",{params:{userId:g.id,friendId:e}}),N()}catch(a){console.error("\uce5c\uad6c \uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",a)}})(s.friend.id,e),children:"\u274c"})]},s.id)))})]}),m&&(0,r.jsx)("div",{className:"modal",children:(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsx)("span",{className:"close",onClick:()=>u(!1),children:"\xd7"}),(0,r.jsxs)("div",{className:"modal-tabs",children:[(0,r.jsx)("button",{className:"modal-tab-button "+("search"===v?"active":""),onClick:()=>f("search"),children:"\uce5c\uad6c \uac80\uc0c9"}),(0,r.jsx)("button",{className:"modal-tab-button "+("pending"===v?"active":""),onClick:()=>f("pending"),children:"\uc694\uccad\ud55c \ubaa9\ub85d"}),(0,r.jsx)("button",{className:"modal-tab-button "+("requests"===v?"active":""),onClick:()=>f("requests"),children:"\ubc1b\uc740 \uce5c\uad6c \uc694\uccad"})]}),"search"===v&&(0,r.jsxs)("div",{className:"friendlist-search-tab",children:[(0,r.jsx)("h2",{children:"\uce5c\uad6c \ucd94\uac00"}),(0,r.jsx)("input",{type:"text",placeholder:"\uac80\uc0c9 (ID, \uc774\uba54\uc77c, \ub2c9\ub124\uc784)",value:p,onChange:e=>x(e.target.value)}),(0,r.jsx)("button",{onClick:async()=>{try{const e=await i.A.get(`/friends/search?keyword=${p}`);y(e.data)}catch(e){console.error("\uc0ac\uc6a9\uc790 \uac80\uc0c9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",e)}},children:"\uac80\uc0c9"}),(0,r.jsx)("div",{className:"search-results",children:j.map((e=>(0,r.jsxs)("div",{className:"search-result-item",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"ID:"})," ",e.id]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"\uc774\uba54\uc77c:"})," ",e.email]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"\ub2c9\ub124\uc784:"})," ",e.nickname]}),(0,r.jsx)("button",{onClick:()=>(async e=>{try{await i.A.post("/friends/add",{userId:g.id,friendId:e}),N(),k()}catch(s){console.error("\uce5c\uad6c \ucd94\uac00\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",s)}})(e.id),disabled:C(e.id),children:C(e.id)?"\uc694\uccad\ub428":"\uce5c\uad6c \ucd94\uac00"})]},e.id)))})]}),"pending"===v&&(0,r.jsxs)("div",{className:"friendlist-pending-tab",children:[(0,r.jsx)("h2",{children:"\uc694\uccad\ud55c \ubaa9\ub85d"}),(0,r.jsx)("div",{className:"pending-requests-list",children:0===o.length?(0,r.jsx)("p",{children:"\uc694\uccad\ud55c \ubaa9\ub85d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):o.map((e=>(console.log(e),(0,r.jsx)("div",{className:"pending-request-item",children:(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"\uc694\uccad\ud55c \uc0ac\uc6a9\uc790 ID:"})," ",e.friend.nickname]})},e.id))))})]}),"requests"===v&&(0,r.jsxs)("div",{className:"friendlist-requests-tab",children:[(0,r.jsx)("h2",{children:"\ubc1b\uc740 \uce5c\uad6c \uc694\uccad"}),(0,r.jsx)("div",{className:"friend-requests-list",children:0===l.length?(0,r.jsx)("p",{children:"\ubc1b\uc740 \uc694\uccad\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):l.map((e=>(console.log(e),(0,r.jsx)("div",{className:"friend-request-item",children:(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"\uc694\uccad\ud55c \uc0ac\uc6a9\uc790:"})," ",e.user.nickname,(0,r.jsx)("button",{className:"accept-button",onClick:()=>(async e=>{try{await i.A.post("/friends/accept",null,{params:{friendRequestId:e}}),N(),b()}catch(s){console.error("\uce5c\uad6c \uc694\uccad \uc218\ub77d\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",s)}})(e.id),children:"\u2705"})]})},e.id))))})]})]})})]})},o=e=>{let{children:s}=e;return(0,r.jsxs)("div",{className:"sidebar-layout-layout",children:[(0,r.jsxs)("div",{className:"sidebar-layout-sidebar",children:[(0,r.jsx)(l.A,{onSelectTrack:()=>{}}),(0,r.jsx)(d,{})]}),(0,r.jsx)("div",{className:"sidebar-layout-main-content",children:s})]})}},6054:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var t=a(5043),l=a(5026),i=a(5422),c=a(1675),n=a(579);const r=e=>{let{streamId:s}=e;const a=(0,c.Zp)();return(0,n.jsx)("button",{className:"join-button",onClick:()=>{s?a(`/chat/${s}`):alert("\ucc44\ud305\ubc29 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.")},children:"\uc785\uc7a5"})};var d=a(9057);const o=a.p+"static/media/defaultImage.84bf0350c85e7a6bfc17.png";var h=a(5520);a(6578);const m=()=>{const[e,s]=(0,t.useState)([]),a=()=>{l.A.get("/api/streaming/live").then((e=>{const a=e.data.map((e=>({...e,public:!0})));s(a)})).catch((e=>console.error("\u274c \uc2a4\ud2b8\ub9ac\ubc0d \ubaa9\ub85d \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328:",e)))};return(0,t.useEffect)((()=>{a();const e=setInterval(a,4e4);return()=>clearInterval(e)}),[]),(0,n.jsxs)("div",{className:"social-container",children:[(0,n.jsx)(i.A,{}),(0,n.jsx)(h.A,{children:(0,n.jsxs)("div",{className:"social-layout-container",children:[(0,n.jsxs)("div",{className:"social-content",children:[(0,n.jsx)("p",{className:"textplace",children:"\ud604\uc7ac \uc9c4\ud589 \uc911\uc778 \uc2a4\ud2b8\ub9ac\ubc0d \ucc44\ud305\ubc29 \ubaa9\ub85d\uc785\ub2c8\ub2e4."}),(0,n.jsx)("div",{className:"streaming-list",children:0===e.length?(0,n.jsx)("p",{className:"textplace",children:"\ud604\uc7ac \uc9c4\ud589 \uc911\uc778 \uc2a4\ud2b8\ub9ac\ubc0d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):e.map((e=>e.public&&(0,n.jsx)("div",{className:"ViewStyle",children:(0,n.jsxs)("div",{className:"stream-card",children:[(0,n.jsxs)("div",{className:"grapplace",children:[(0,n.jsx)("div",{className:"sectionleft",children:(0,n.jsx)("img",{src:o,alt:"defaultImage",id:"defaultImageStyle"})}),(0,n.jsxs)("div",{className:"sectionright",children:[(0,n.jsx)("p",{id:"TitlePlace",children:e.playlist.playlistTitle}),(0,n.jsxs)("h5",{id:"placebottom",children:["\uc2a4\ud2b8\ub9ac\ubc0d \ud638\uc2a4\ud2b8 ID: ",e.hostUser.nickname]})]})]}),(0,n.jsxs)("div",{className:"chat-box",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"\ub9c8\uc9c0\ub9c9 \ucc44\ud305:"})," ",e.lastMessage?e.lastMessage:"\uba54\uc2dc\uc9c0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."]}),(0,n.jsx)(r,{streamId:e.id})]})]},e.id)})))})]}),(0,n.jsx)(d.A,{})]})})]})}},6375:(e,s,a)=>{a.d(s,{A:()=>c});var t=a(5043),l=a(5026),i=a(6213);const c=()=>{const[e,s]=(0,t.useState)(""),[a,c]=(0,t.useState)([]),[n,r]=(0,t.useState)(new Audio),[d,o]=(0,t.useState)(!1),[h,m]=(0,t.useState)(null);(0,t.useEffect)((()=>{(async()=>{try{const e=await l.A.get("/api/spotify/userInfo");o("premium"===e.data.product)}catch(e){}})()}),[]),(0,t.useEffect)((()=>{(async()=>{try{const e=(await l.A.get("/music/devices",{headers:{Authorization:`Bearer ${localStorage.getItem("MUSICOVERY_ACCESS_TOKEN")}`}})).data.devices;e.length>0&&(m(e[0].id),await(async e=>{try{const s="https://api.spotify.com/v1/me/player";await i.A.put(s,{device_ids:[e],play:!0},{headers:{Authorization:`Bearer ${localStorage.getItem("MUSICOVERY_ACCESS_TOKEN")}`}})}catch(s){throw console.error("Failed to transfer playback:",s),s}})(e[0].id))}catch(e){console.error("Failed to fetch devices",e)}})()}),[]);return{keyword:e,setKeyword:s,results:a,handleSearch:async s=>{try{const s=(await l.A.get(`/api/spotify/search?keyword=${e}&type=track`)).data.tracks.items.filter((e=>e.is_playable));c(s)}catch(a){console.error("Failed to search music",a),c([])}},isPremium:d,deviceId:h}}},6578:()=>{},7138:(e,s,a)=>{a.d(s,{N:()=>i,V:()=>l});const t="https://easy-turtles-flash.loca.lt/images/default.png",l=e=>e?e.startsWith("/images/")?`https://easy-turtles-flash.loca.lt${e}`:e:t,i=()=>t},9057:(e,s,a)=>{a.d(s,{A:()=>i});a(5043);var t=a(1675),l=a(579);const i=()=>(0,l.jsx)("aside",{className:"social-sidebar",children:(0,l.jsx)("nav",{className:"nav-menu",children:(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:(0,l.jsx)(t.N_,{to:"/quiz",children:"AI\uac00\uc0ac \ud034\uc988"})}),(0,l.jsx)("li",{children:(0,l.jsx)(t.N_,{to:"/songquiz",children:"\ub178\ub798\ud034\uc988"})}),(0,l.jsx)("li",{children:(0,l.jsx)(t.N_,{to:"/streaming",children:"\uc2a4\ud2b8\ub9ac\ubc0d"})})]})})})}}]);
//# sourceMappingURL=321.6340edaf.chunk.js.map